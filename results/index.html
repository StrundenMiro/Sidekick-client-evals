<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sidekick Eval</title>
  <style>
    :root {
      --primary: #4F46E5;
      --success: #10B981;
      --warning: #F59E0B;
      --danger: #EF4444;
      --gray-50: #F9FAFB;
      --gray-100: #F3F4F6;
      --gray-200: #E5E7EB;
      --gray-300: #D1D5DB;
      --gray-400: #9CA3AF;
      --gray-600: #4B5563;
      --gray-700: #374151;
      --gray-800: #1F2937;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--gray-50); color: var(--gray-800); line-height: 1.5; }

    /* Navigation */
    .nav { background: var(--gray-800); padding: 0.75rem 2rem; position: sticky; top: 0; z-index: 100; }
    .nav-content { max-width: 1200px; margin: 0 auto; display: flex; align-items: center; gap: 1.5rem; }
    .nav-logo { color: white; font-weight: 700; font-size: 1rem; cursor: pointer; }
    .nav-formats { display: flex; gap: 0.25rem; }
    .nav-format { color: var(--gray-400); text-decoration: none; padding: 0.35rem 0.6rem; border-radius: 4px; font-size: 0.8rem; text-transform: capitalize; cursor: pointer; display: flex; align-items: center; gap: 0.4rem; }
    .nav-format:hover { background: rgba(255,255,255,0.1); color: white; }
    .nav-format.active { background: var(--primary); color: white; }
    .nav-format-score { font-size: 0.7rem; opacity: 0.8; }
    .nav-format-dot { width: 6px; height: 6px; border-radius: 50%; }
    .nav-format-dot.pass { background: var(--success); }
    .nav-format-dot.warning { background: var(--warning); }
    .nav-format-dot.fail { background: var(--danger); }

    .container { max-width: 1200px; margin: 0 auto; padding: 1.5rem; }

    /* Dashboard */
    .dashboard-header { margin-bottom: 1.5rem; }
    .dashboard-header h1 { font-size: 1.5rem; font-weight: 600; margin-bottom: 0.25rem; }
    .dashboard-header p { color: var(--gray-600); font-size: 0.9rem; }

    .format-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; }

    .format-card { background: white; border-radius: 8px; padding: 1.25rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.1s, box-shadow 0.1s; }
    .format-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .format-card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem; }
    .format-card h3 { font-size: 1rem; font-weight: 600; text-transform: capitalize; }
    .format-card-score { font-size: 1.5rem; font-weight: 700; }
    .format-card-score.pass { color: var(--success); }
    .format-card-score.warning { color: var(--warning); }
    .format-card-score.fail { color: var(--danger); }
    .format-card-meta { font-size: 0.8rem; color: var(--gray-600); }
    .format-card-runs { margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--gray-100); font-size: 0.8rem; color: var(--gray-600); }

    /* Format History View */
    .back-link { display: inline-flex; align-items: center; justify-content: center; width: 28px; height: 28px; color: var(--gray-600); text-decoration: none; font-size: 1rem; background: var(--gray-100); border-radius: 4px; }
    .back-link:hover { background: var(--gray-200); color: var(--gray-800); }

    .format-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--gray-200); }
    .format-header h1 { font-size: 1.5rem; font-weight: 600; text-transform: capitalize; }

    .run-list { display: flex; flex-direction: column; gap: 0.75rem; }
    .run-item { background: white; border-radius: 8px; padding: 1rem 1.25rem; box-shadow: 0 1px 2px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: background 0.1s; }
    .run-item:hover { background: var(--gray-50); }
    .run-item-info h4 { font-size: 0.9rem; font-weight: 600; margin-bottom: 0.25rem; }
    .run-item-info p { font-size: 0.8rem; color: var(--gray-600); }
    .run-item-scores { display: flex; gap: 1rem; align-items: center; }
    .run-item-score { text-align: center; }
    .run-item-score .value { font-size: 1.25rem; font-weight: 700; }
    .run-item-score .label { font-size: 0.65rem; color: var(--gray-600); text-transform: uppercase; }
    .run-item-score.pass .value { color: var(--success); }
    .run-item-score.warning .value { color: var(--warning); }
    .run-item-score.fail .value { color: var(--danger); }

    /* Run Detail View */
    .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--gray-200); }
    .header h1 { font-size: 1.5rem; font-weight: 600; }
    .header-meta { display: flex; gap: 1rem; font-size: 0.85rem; color: var(--gray-600); }

    /* Run summary lists */
    .run-summary { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem; }
    .summary-list { background: white; border-radius: 8px; padding: 1rem 1.25rem; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
    .summary-list h3 { font-size: 0.85rem; font-weight: 600; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
    .summary-list h3.good { color: var(--success); }
    .summary-list h3.bad { color: var(--danger); }
    .summary-list ul { list-style: none; font-size: 0.85rem; color: var(--gray-700); }
    .summary-list li { padding: 0.35rem 0; padding-left: 1.25rem; position: relative; }
    .summary-list li::before { content: ''; position: absolute; left: 0; top: 0.65rem; width: 6px; height: 6px; border-radius: 50%; }
    .summary-list.good li::before { background: var(--success); }
    .summary-list.bad li::before { background: var(--danger); }
    .summary-list.empty { color: var(--gray-500); font-style: italic; font-size: 0.85rem; }
    @media (max-width: 640px) { .run-summary { grid-template-columns: 1fr; } }

    .prompt-card { background: white; border-radius: 8px; margin-bottom: 1rem; box-shadow: 0 1px 2px rgba(0,0,0,0.05); overflow: hidden; }
    .prompt-header { padding: 0.75rem 1rem; background: var(--gray-50); border-bottom: 1px solid var(--gray-100); display: flex; justify-content: space-between; align-items: center; }
    .prompt-header h3 { font-size: 0.9rem; font-weight: 600; }
    .prompt-status { font-size: 0.75rem; padding: 0.2rem 0.5rem; border-radius: 4px; font-weight: 500; }
    .prompt-status.pass { background: #D1FAE5; color: #065F46; }
    .prompt-status.fail { background: #FEE2E2; color: #991B1B; }
    .prompt-status.warning { background: #FEF3C7; color: #92400E; }
    .prompt-body { padding: 1rem; }
    .prompt-text { background: var(--gray-50); padding: 0.75rem; border-radius: 6px; font-size: 0.85rem; margin-bottom: 0.75rem; font-family: monospace; white-space: pre-wrap; }
    .prompt-note { font-size: 0.85rem; color: var(--gray-700); margin-bottom: 0.75rem; padding: 0.5rem 0.75rem; border-radius: 6px; background: #D1FAE5; }
    .prompt-note.fail { background: #FEE2E2; color: #991B1B; }
    .prompt-note.warning { background: #FEF3C7; color: #92400E; }
    .artifact-img { border: 1px solid var(--gray-200); border-radius: 6px; overflow: hidden; }
    .artifact-img img { width: 100%; max-height: 400px; object-fit: contain; display: block; cursor: pointer; background: var(--gray-100); transition: opacity 0.15s; }
    .artifact-img img:hover { opacity: 0.9; }

    /* Lightbox */
    .lightbox { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); z-index: 2000; display: flex; align-items: center; justify-content: center; cursor: zoom-out; }
    .lightbox img { max-width: 95vw; max-height: 95vh; object-fit: contain; border-radius: 4px; }
    .lightbox-close { position: absolute; top: 1rem; right: 1rem; color: white; font-size: 2rem; cursor: pointer; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: rgba(255,255,255,0.1); }
    .lightbox-close:hover { background: rgba(255,255,255,0.2); }

    footer { text-align: center; padding: 1.5rem; color: var(--gray-600); font-size: 0.8rem; }

    .loading { text-align: center; padding: 3rem; color: var(--gray-600); }
    .error { text-align: center; padding: 3rem; color: var(--danger); }

    /* Delete button */
    .delete-btn {
      background: transparent;
      border: 1px solid var(--gray-300);
      color: var(--gray-600);
      padding: 0.35rem 0.6rem;
      border-radius: 4px;
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.15s;
    }
    .delete-btn:hover {
      background: var(--danger);
      border-color: var(--danger);
      color: white;
    }
    .run-item-actions { display: flex; gap: 0.5rem; align-items: center; }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal {
      background: white;
      border-radius: 8px;
      padding: 1.5rem;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }
    .modal h3 { margin-bottom: 0.75rem; }
    .modal p { color: var(--gray-600); font-size: 0.9rem; margin-bottom: 1rem; }
    .modal-actions { display: flex; gap: 0.5rem; justify-content: flex-end; }
    .modal-btn {
      padding: 0.5rem 1rem;
      border-radius: 4px;
      font-size: 0.85rem;
      cursor: pointer;
      border: none;
    }
    .modal-btn-cancel { background: var(--gray-200); color: var(--gray-700); }
    .modal-btn-cancel:hover { background: var(--gray-300); }
    .modal-btn-danger { background: var(--danger); color: white; }
    .modal-btn-danger:hover { background: #DC2626; }

    /* Consolidated run header */
    .run-header {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--gray-200);
      gap: 1rem;
    }
    .run-header-left { display: flex; align-items: center; gap: 0.75rem; }
    .run-header-left h1 { font-size: 1.25rem; font-weight: 600; text-transform: capitalize; white-space: nowrap; }
    .run-header-nav { display: flex; align-items: center; gap: 0.5rem; justify-content: center; }
    .run-header-nav button {
      padding: 0.4rem 0.6rem;
      background: var(--gray-100);
      border: none;
      border-radius: 4px;
      color: var(--gray-700);
      font-size: 0.75rem;
      cursor: pointer;
    }
    .run-header-nav button:hover:not(:disabled) { background: var(--gray-200); }
    .run-header-nav button:disabled { opacity: 0.3; cursor: not-allowed; }
    .run-header-nav span { font-size: 0.8rem; color: var(--gray-500); min-width: 40px; text-align: center; }
    .run-header-right { display: flex; align-items: center; gap: 1rem; font-size: 0.8rem; color: var(--gray-600); justify-content: flex-end; }
    .icon-btn { background: transparent; border: 1px solid var(--gray-300); color: var(--gray-600); width: 32px; height: 32px; border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1rem; }
    .icon-btn:hover { background: var(--gray-100); }
    .icon-btn.delete:hover { background: var(--danger); border-color: var(--danger); color: white; }
  </style>
</head>
<body>
  <nav class="nav">
    <div class="nav-content">
      <div class="nav-logo" onclick="showDashboard()">Sidekick Eval</div>
      <div class="nav-formats" id="nav-formats"></div>
    </div>
  </nav>

  <div class="container" id="app">
    <div class="loading">Loading...</div>
  </div>

  <footer>
    For questions &amp; feedback message <a href="slack://channel?team=T028Q5EBK&id=D02SQCTE1HD">Fabian Strunden</a>
  </footer>

  <div id="modal-container"></div>
  <div id="lightbox-container"></div>

  <!-- Load runs data (works with file:// protocol) -->
  <script src="data/runs.js"></script>

  <script>
    let runs = [];
    let currentView = 'dashboard';
    let currentFormat = null;
    let currentRunId = null;

    // Load data
    async function loadData() {
      // Try to use embedded RUNS_DATA first (for file:// protocol)
      if (typeof RUNS_DATA !== 'undefined') {
        runs = RUNS_DATA.runs;
        renderNavFormats();
        showDashboard();
        return;
      }

      // Fall back to fetch for http:// servers
      try {
        const response = await fetch('data/runs.json');
        const data = await response.json();
        runs = data.runs;
        renderNavFormats();
        showDashboard();
      } catch (error) {
        document.getElementById('app').innerHTML = `<div class="error">Error loading data: ${error.message}<br><br>If using file:// protocol, ensure data/runs.js exists.</div>`;
      }
    }

    // Render format tabs in nav
    function renderNavFormats() {
      const formats = getFormats();
      const formatOrder = ['table', 'stickies', 'document', 'prototype', 'flowchart', 'slides', 'image'];

      let html = '';
      formatOrder.forEach(format => {
        if (formats[format]) {
          const { latest } = formats[format];
          const scoreClass = getScoreClass(latest.scores.overall);
          const isActive = currentFormat === format ? 'active' : '';
          html += `
            <div class="nav-format ${isActive}" onclick="showLatestRun('${format}')">
              <span class="nav-format-dot ${scoreClass}"></span>
              ${format}
            </div>
          `;
        }
      });
      document.getElementById('nav-formats').innerHTML = html;
    }

    // Get score class
    function getScoreClass(score) {
      if (score >= 8) return 'pass';
      if (score >= 5) return 'warning';
      return 'fail';
    }

    // Format date
    function formatDate(timestamp) {
      // Handle ISO format without timezone (treat as local)
      const date = new Date(timestamp);
      if (isNaN(date.getTime())) {
        return 'Invalid date';
      }
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    }

    // Format time
    function formatTime(timestamp) {
      // Handle ISO format without timezone (treat as local)
      const date = new Date(timestamp);
      if (isNaN(date.getTime())) {
        return '';
      }
      return date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
    }

    // Format relative time
    function formatRelativeTime(timestamp) {
      const date = new Date(timestamp);
      const now = new Date();
      const diffMs = now - date;
      const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));

      if (diffDays === 0) return 'Today';
      if (diffDays === 1) return 'Yesterday';
      if (diffDays < 7) return `${diffDays} days ago`;
      return formatDate(timestamp);
    }

    // Get runs by format
    function getRunsByFormat(format) {
      return runs.filter(r => r.format === format).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
    }

    // Go to latest run for a format
    function showLatestRun(format) {
      const formatRuns = getRunsByFormat(format);
      if (formatRuns.length > 0) {
        showRun(formatRuns[0].id);
      }
    }

    // Show delete confirmation modal
    function confirmDelete(runId, event) {
      if (event) event.stopPropagation();
      const run = runs.find(r => r.id === runId);
      if (!run) return;

      const modalHtml = `
        <div class="modal-overlay" onclick="closeModal()">
          <div class="modal" onclick="event.stopPropagation()">
            <h3>Delete Run?</h3>
            <p>Are you sure you want to delete the <strong>${run.format}</strong> test from <strong>${formatDate(run.timestamp)}</strong>? This will remove the run data and its artifacts.</p>
            <div class="modal-actions">
              <button class="modal-btn modal-btn-cancel" onclick="closeModal()">Cancel</button>
              <button class="modal-btn modal-btn-danger" onclick="deleteRun('${runId}')">Delete</button>
            </div>
          </div>
        </div>
      `;
      document.getElementById('modal-container').innerHTML = modalHtml;
    }

    // Close modal
    function closeModal() {
      document.getElementById('modal-container').innerHTML = '';
    }

    // Delete run
    async function deleteRun(runId) {
      const run = runs.find(r => r.id === runId);
      if (!run) return;

      // Remove from runs array
      runs = runs.filter(r => r.id !== runId);

      // Save updated runs to localStorage as backup
      localStorage.setItem('sidekick-eval-runs', JSON.stringify(runs));

      // Generate the updated JSON for manual save
      const updatedJson = JSON.stringify({ runs }, null, 2);

      // Copy to clipboard
      try {
        await navigator.clipboard.writeText(updatedJson);
        alert('Run deleted! Updated JSON copied to clipboard.\\n\\nTo permanently save, paste this into:\\nresults/data/runs.json\\n\\nOr ask Claude to delete the run and its artifacts.');
      } catch (err) {
        console.log('Updated runs:', updatedJson);
        alert('Run deleted from view.\\n\\nTo permanently delete, ask Claude to remove run "' + runId + '" from runs.json');
      }

      closeModal();

      // Refresh view
      if (currentView === 'run') {
        if (runs.filter(r => r.format === run.format).length > 0) {
          showFormat(run.format);
        } else {
          showDashboard();
        }
      } else {
        showFormat(run.format);
      }
      renderNavFormats();
    }

    // Get all formats with stats
    function getFormats() {
      const formats = {};
      runs.forEach(run => {
        if (!formats[run.format]) {
          formats[run.format] = { runs: [], latest: null };
        }
        formats[run.format].runs.push(run);
      });

      Object.keys(formats).forEach(format => {
        formats[format].runs.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        formats[format].latest = formats[format].runs[0];
      });

      return formats;
    }

    // Show dashboard
    function showDashboard() {
      currentView = 'dashboard';
      currentFormat = null;
      currentRunId = null;
      renderNavFormats();

      const formats = getFormats();
      const formatOrder = ['table', 'stickies', 'document', 'prototype', 'flowchart', 'slides', 'image'];

      let html = `
        <div class="dashboard-header">
          <h1>Test Results Dashboard</h1>
          <p>${runs.length} test runs across ${Object.keys(formats).length} formats</p>
        </div>
        <div class="format-grid">
      `;

      formatOrder.forEach(format => {
        if (formats[format]) {
          const { latest, runs: formatRuns } = formats[format];
          const scoreClass = getScoreClass(latest.scores.overall);
          html += `
            <div class="format-card" onclick="showLatestRun('${format}')">
              <div class="format-card-header">
                <h3>${format}</h3>
                <div class="format-card-score ${scoreClass}">${latest.scores.overall}/10</div>
              </div>
              <div class="format-card-meta">
                Latest: ${formatDate(latest.timestamp)}
              </div>
              <div class="format-card-runs">
                ${formatRuns.length} run${formatRuns.length !== 1 ? 's' : ''}
              </div>
            </div>
          `;
        }
      });

      html += '</div>';
      document.getElementById('app').innerHTML = html;
    }

    // Show format history
    function showFormat(format) {
      currentView = 'format';
      currentFormat = format;
      currentRunId = null;
      renderNavFormats();

      const formatRuns = getRunsByFormat(format);

      let html = `
        <div class="format-header">
          <h1>${format} Tests</h1>
          <div style="color: var(--gray-600); font-size: 0.9rem;">${formatRuns.length} run${formatRuns.length !== 1 ? 's' : ''}</div>
        </div>
        <div class="run-list">
      `;

      formatRuns.forEach(run => {
        const overallClass = getScoreClass(run.scores.overall);
        const adherenceClass = getScoreClass(run.scores.promptAdherence);
        const iterationClass = getScoreClass(run.scores.iterationQuality);

        html += `
          <div class="run-item" onclick="showRun('${run.id}')">
            <div class="run-item-info">
              <h4>${formatDate(run.timestamp)} at ${formatTime(run.timestamp)}</h4>
              <p>${run.prompts.length} prompts &middot; ${run.issues.filter(i => i.severity === 'high').length} high-severity issues</p>
            </div>
            <div class="run-item-actions">
              <div class="run-item-scores">
                <div class="run-item-score ${overallClass}">
                  <div class="value">${run.scores.overall}</div>
                  <div class="label">Overall</div>
                </div>
                <div class="run-item-score ${adherenceClass}">
                  <div class="value">${run.scores.promptAdherence}</div>
                  <div class="label">Adherence</div>
                </div>
                <div class="run-item-score ${iterationClass}">
                  <div class="value">${run.scores.iterationQuality}</div>
                  <div class="label">Iteration</div>
                </div>
              </div>
              <button class="delete-btn" onclick="confirmDelete('${run.id}', event)">Delete</button>
            </div>
          </div>
        `;
      });

      html += '</div>';
      document.getElementById('app').innerHTML = html;
    }

    // Show run detail
    function showRun(runId) {
      const run = runs.find(r => r.id === runId);
      if (!run) return;

      currentView = 'run';
      currentFormat = run.format;
      currentRunId = runId;
      renderNavFormats();

      // Get runs for this format for navigation
      const formatRuns = getRunsByFormat(run.format);
      const currentIndex = formatRuns.findIndex(r => r.id === runId);
      const prevRun = currentIndex < formatRuns.length - 1 ? formatRuns[currentIndex + 1] : null;
      const nextRun = currentIndex > 0 ? formatRuns[currentIndex - 1] : null;

      let html = `
        <div class="run-header">
          <div class="run-header-left">
            <button class="icon-btn" onclick="showFormat('${run.format}')" title="All ${run.format} runs">‚ò∞</button>
            <h1>${run.format}</h1>
          </div>
          <div class="run-header-nav">
            <button onclick="showRun('${prevRun?.id}')" ${!prevRun ? 'disabled' : ''} title="Older run">‚Üê</button>
            <span>${currentIndex + 1}/${formatRuns.length}</span>
            <button onclick="showRun('${nextRun?.id}')" ${!nextRun ? 'disabled' : ''} title="Newer run">‚Üí</button>
          </div>
          <div class="run-header-right">
            <span>${formatDate(run.timestamp)} ${formatTime(run.timestamp)}</span>
            <button class="icon-btn delete" onclick="confirmDelete('${run.id}')" title="Delete run">üóë</button>
          </div>
        </div>

        <div class="run-summary">
          <div class="summary-list good">
            <h3 class="good">‚úì What worked</h3>
            ${run.good && run.good.length > 0
              ? `<ul>${run.good.map(item => `<li>${item}</li>`).join('')}</ul>`
              : '<p class="empty">Nothing notable</p>'}
          </div>
          <div class="summary-list bad">
            <h3 class="bad">‚úó What didn't</h3>
            ${run.bad && run.bad.length > 0
              ? `<ul>${run.bad.map(item => `<li>${item}</li>`).join('')}</ul>`
              : '<p class="empty">No issues</p>'}
          </div>
        </div>
      `;

      run.prompts.forEach(prompt => {
        const noteClass = prompt.status === 'fail' ? 'fail' : (prompt.status === 'warning' ? 'warning' : '');
        html += `
          <div class="prompt-card">
            <div class="prompt-header">
              <h3>Prompt ${prompt.number}: ${prompt.title}</h3>
              <span class="prompt-status ${prompt.status}">${prompt.status.charAt(0).toUpperCase() + prompt.status.slice(1)}</span>
            </div>
            <div class="prompt-body">
              <div class="prompt-text">${prompt.text}</div>
              <div class="prompt-note ${noteClass}">${prompt.note}</div>
              <div class="artifact-img">
                <img src="${prompt.artifact}" alt="V${prompt.number} Artifact" loading="lazy" onclick="openLightbox('${prompt.artifact}', 'V${prompt.number}: ${prompt.title}')">
              </div>
            </div>
          </div>
        `;
      });

      document.getElementById('app').innerHTML = html;
    }

    // Lightbox functions
    function openLightbox(src, title) {
      const html = `
        <div class="lightbox" onclick="closeLightbox()">
          <div class="lightbox-close" onclick="closeLightbox()">&times;</div>
          <img src="${src}" alt="${title}" onclick="event.stopPropagation()">
        </div>
      `;
      document.getElementById('lightbox-container').innerHTML = html;
      document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
      document.getElementById('lightbox-container').innerHTML = '';
      document.body.style.overflow = '';
    }

    // Close lightbox on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeLightbox();
    });

    // Initialize
    loadData();
  </script>
</body>
</html>
